{"ast":null,"code":"var _jsxFileName = \"/Users/asiataylor/Development/env1/django-drf-react/project/frontend/src/components/views/Topic.js\";\nimport React, { Component } from 'react';\nimport { connect } from \"react-redux\";\nimport '../static/Home.css';\nimport Navbar from './Navbar';\nimport '../static/Forum.css';\nimport TextareaAutosize from 'react-textarea-autosize';\nimport { headers } from '../forms/global.js';\nimport Comments from './Comments';\n\nclass Topic extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      posts: [],\n      topic: \"\",\n      meta: null,\n      avi: null\n    };\n\n    this.fetchPosts = () => {\n      headers[\"Authorization\"] = \"Token \".concat(this.props.token);\n      fetch(\"/api/post/\".concat(this.props.match.params.topic_id, \"/\"), {\n        headers,\n        method: \"GET\"\n      }).then(response => {\n        return response.json();\n      }).then(responseData => {\n        return responseData;\n      }).then(json => {\n        this.setState({\n          posts: json.data\n        });\n        this.setState({\n          topic: json.topic\n        });\n        this.setState({\n          meta: json.meta\n        });\n        this.setState({\n          avi: json.user_avi\n        });\n      }).catch(err => {\n        console.log(\"fetch error\" + err);\n      });\n    };\n\n    this.newPost = (topic, category, text, reply_to, user_id) => {\n      let body = JSON.stringify({\n        topic,\n        category,\n        text,\n        reply_to,\n        user_id\n      });\n      headers[\"Authorization\"] = \"Token \".concat(this.props.token);\n      return fetch(\"/api/post/\".concat(this.props.match.params.topic_id, \"/\"), {\n        headers,\n        body,\n        method: \"POST\"\n      }).then(res => {\n        return res.json();\n      }).then(() => this.fetchPosts()).catch(err => {\n        console.log(\"fetch error\" + err);\n      });\n    };\n\n    this.submitPost = e => {\n      e.preventDefault();\n      this.newPost(this.props.match.params.topic_id, this.props.match.params.category_id, this.state.post, null, this.props.user.id);\n    };\n  }\n\n  componentWillMount() {\n    this.fetchPosts();\n  }\n\n  render() {\n    var avi = this.state.avi;\n    return React.createElement(\"div\", {\n      id: \"topic\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50\n      },\n      __self: this\n    }, React.createElement(\"header\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51\n      },\n      __self: this\n    }, React.createElement(Navbar, {\n      history: this.props.history,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"flex-box\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"forum-body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"post-list\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      className: \"forum-h1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57\n      },\n      __self: this\n    }, this.state.topic), React.createElement(\"div\", {\n      className: \"post\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"post-avi\",\n      style: avi ? {\n        backgroundImage: \"url(\".concat(avi, \")\")\n      } : {},\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60\n      },\n      __self: this\n    }, React.createElement(TextareaAutosize, {\n      id: \"new-post\",\n      onChange: e => this.setState({\n        post: e.target.value\n      }),\n      maxLength: \"500\",\n      minRows: 1,\n      maxRows: 6,\n      placeholder: \"Create a post...\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      onClick: this.submitPost,\n      className: \"post-submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    }, \"Post\"))), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66\n      },\n      __self: this\n    }, React.createElement(Comments, {\n      fetchPosts: this.fetchPosts,\n      newPost: this.newPost,\n      match: this.props.match,\n      comments: this.state.posts,\n      meta: this.state.meta,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }))))));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    user: state.auth.user,\n    token: state.auth.token\n  };\n};\n\nexport default connect(mapStateToProps)(Topic);","map":{"version":3,"sources":["/Users/asiataylor/Development/env1/django-drf-react/project/frontend/src/components/views/Topic.js"],"names":["React","Component","connect","Navbar","TextareaAutosize","headers","Comments","Topic","state","posts","topic","meta","avi","fetchPosts","props","token","fetch","match","params","topic_id","method","then","response","json","responseData","setState","data","user_avi","catch","err","console","log","newPost","category","text","reply_to","user_id","body","JSON","stringify","res","submitPost","e","preventDefault","category_id","post","user","id","componentWillMount","render","history","backgroundImage","target","value","mapStateToProps","auth"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {connect} from \"react-redux\";\nimport '../static/Home.css';\nimport Navbar from './Navbar';\nimport '../static/Forum.css';\nimport TextareaAutosize from 'react-textarea-autosize';\nimport {headers} from '../forms/global.js'\nimport Comments from './Comments';\n\n\nclass Topic extends Component{\n\n    state = {\n      posts:[],\n      topic:\"\",\n      meta:null,\n      avi:null,\n    }\n\n    fetchPosts =()=>{\n      headers[\"Authorization\"] = `Token ${this.props.token}`;\n      fetch(`/api/post/${this.props.match.params.topic_id}/`,{headers,method:\"GET\"})\n        .then(response => { return response.json();}).then(responseData => {return responseData;})\n        .then (json => {this.setState({posts: json.data}); this.setState({topic:json.topic});\n        this.setState({meta:json.meta}); this.setState({avi:json.user_avi});})\n        .catch(err => {console.log(\"fetch error\" + err);\n         });\n    }\n\n    newPost = (topic,category,text,reply_to,user_id)=>{\n      let body = JSON.stringify({topic,category,text,reply_to,user_id});\n      headers[\"Authorization\"] = `Token ${this.props.token}`;\n      return fetch(`/api/post/${this.props.match.params.topic_id}/`, {headers,body,method:\"POST\"})\n        .then(res => {return res.json();}).then(()=>this.fetchPosts())\n        .catch(err => {console.log(\"fetch error\" + err)})\n    }\n\n    submitPost = (e) =>{\n      e.preventDefault();\n      this.newPost(this.props.match.params.topic_id,this.props.match.params.category_id,this.state.post,null,this.props.user.id)\n    }\n\n    componentWillMount(){\n      this.fetchPosts()\n    }\n\n  render(){\n    var avi = this.state.avi;\n    return(\n    <div id=\"topic\">\n      <header>\n        <Navbar history={this.props.history}/>\n      </header>\n      <div className=\"flex-box\">\n        <div className=\"forum-body\">\n            <div id=\"post-list\">\n              <h1 className=\"forum-h1\">{this.state.topic}</h1>\n              <div className=\"post\">\n              <div className=\"post-avi\" style = {avi ? {backgroundImage: `url(${avi})`} : {}}></div>\n              <div className=\"text\">\n                <TextareaAutosize id=\"new-post\" onChange={e => this.setState({post: e.target.value})} maxLength=\"500\" minRows={1} maxRows={6}\n                 placeholder=\"Create a post...\"/>\n                <button onClick={this.submitPost} className=\"post-submit\">Post</button>\n              </div>\n              </div>\n              <div>\n              <Comments fetchPosts={this.fetchPosts} newPost={this.newPost} match={this.props.match}\n              comments={this.state.posts} meta={this.state.meta} />\n              </div>\n            </div>\n\n        </div>\n      </div>\n    </div>\n    )\n  }\n}\n\nconst mapStateToProps = state => {\n    return {\n      user: state.auth.user,\n      token:state.auth.token,\n    }\n}\n\nexport default connect(mapStateToProps)(Topic);\n"]},"metadata":{},"sourceType":"module"}